@{
    ViewBag.Title = "Docentes";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<p>
    <a href="#" onclick="PopupForm('@Url.Action("Create","Docentes")')">Crear <i class="glyphicon glyphicon-edit"></i></a>
</p>
<table class="table table-striped table-hover" id="docentesTabla">
    <thead>
        <tr>
            <th>
                Departamento
            </th>
            <th>
                Especialidad
            </th>
            <th>
                Nombre
            </th>
            <th>
                Apellido
            </th>
            <th>
                Telefono
            </th>
            <th>
                Correo
            </th>
            <th>Opciones</th>
        </tr>
    </thead>
</table>
@section scripts
{
<script src="~/Scripts/DataTables/jquery.dataTables.min.js"></script>
<script src="~/Scripts/DataTables/dataTables.jqueryui.min.js"></script>
<script>
    var Popup, dataTable;
    $(document).ready(function () {
        dataTable = $("#docentesTabla").DataTable({
            "ajax": {
                "url": "/Docentes/getDocentes",
                "type": "GET",
                "datatype": "json"
            },
            "columns": [
                { "data": "Departamento.nombre" },
                { "data": "Especialidad.nombre" },
                { "data": "Nombre" },
                { "data": "Apellido" },
                { "data": "Telefono" },
                { "data": "Email" },
                {
                    "data": "DocenteId", "render": function (data) {
                        return "<a href='#' onclick=PopupForm('@Url.Action("Create","Docentes")/" + data + "')><i class='fa fa-pencil'></i> Editar </a> |<a href='#' style='margin-left:1px' onclick=Delete("+data+")><i class='fa fa-trash'></i> Borrar</a>";
                    },
                    "orderable": false,
                    "searcheable": false
                }
            ], "language": {
                "emptyTable": "No hay departamentos en el sistema",
                "url": "//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/Spanish.json"
            }
        });
    });

    function PopupForm(url) {
        var formDiv = $('<div/>');
        $.get(url)
        .done(function (response) {
            formDiv.html(response);

            Popup = formDiv.dialog({
                autoOpen: true,
                resizable: false,
                title: 'Datos de Departamento',
                height: 600,
                width: 600,
                close: function () {
                    Popup.dialog('destroy').remove();
                }

            });
        });
    }

    function SubmitForm(form) {
        $.validator.unobtrusive.parse(form);
        if ($(form).valid()) {
            $.ajax({
                type: "POST",
                url: form.action,
                data: $(form).serialize(),
                success: function (data) {
                    if (data.success) {
                        Popup.dialog('close');
                        dataTable.ajax.reload();

                        $.notify(data.message, {
                            globalPosition: "top center",
                            className: "success"
                        })

                    }
                }
            });
        }
        return false;
    }

    function Delete(id) {
        //Yo no se qui onda
        if (confirm('Confirme Eliminación')) {
            $.ajax({
                type: "POST",
                url: '@Url.Action("Delete","Docentes")/' + id,
                success: function (data) {
                    if (data.success) {
                        dataTable.ajax.reload();

                        $.notify(data.message, {
                            globalPosition: "top center",
                            className: "success"
                        })

                    }
                }

            });
        }
    }
</script>
}